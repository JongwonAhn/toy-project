2022/05/02
도커&쿠버네티스 라는 단어를 많이 들어봤다.
도대체 무엇일까? 도커부터 직접 공부해보자.

도커를 왜 쓸까?
- 어떤 프로그램을 다운 받는 과정을 간단하게 만들기 위해서 이다.

어떻길래 간단할까?
- 프로그램을 일반적으로 다운로드 받을경우, Installer 다운 - Installer 실행 - 설치완료의 과정이지만,
  이 과정에서 많은 에러가 발생할수 있다. Installer가 운영체제, 패키지버전, 서버 등 많은곳에서 영향을 받기 때문이다.
  예를들어 도커로 redis를 다운 받을경우 도커 클라이언트에서 docker run redis하면 손쉽게 받을수 있다.
  
도커는 무엇인가?
- 컨테이너를 사용하여 응용프로그램을 더 쉽게 만들고 배포하고 실행할 수 있도록 설계된 도구.
  컨테이너 기반의 오픈소스 가상화 플랫폼이며 생태계이다
  
컨테이너는 무엇인가?
- 다양한 프로그램, 실행환경을 컨테이너에 담아(추상화) 동일한 인터페이스를 제공하여 프로그램의 배포 및 관리를 단순하게 해준다.
  즉 코드와 모든 종속성을 패키지화 하여 응용프로그램이 다른 컴퓨팅 환경으로 빠르고 안정적으로 실행하게 해준다.
  https://www.docker.com/resources/what-container/ 
  
컨테이너 이미지란?
- 코드, 런타임, 시스템 도구, 라이브러리 및 설정과 같은 응용프로그램을 실행하는데 필요한 모든것을 포함하는
  가볍고 독립적으로 실행가능한 소프트웨어 패키지이다.
  도커 이미지를 이용해서 도커 컨테이너를 생성하고, 도커 컨테이너를 이용해서 프로그램을 실행한다.
  
도커 설치하기
- docker.com - get started - download for OS - Docker 사이트 회원가입 - hub.docker.com - Docker 로그인 - docker version
* Window Home은 Docker ToolBox or WSL 추가 필요.

도커의 흐름
- 도커Clinet(CLI)입력시 -> 도커 Server(Daemon)가 커맨드를 받아서 이미지생성, 컨테이너실행 과 같은 작업 수행
  ex) docker run hello-world -> 명령어를 도커 클라이언트가 도커 서버로 보내, 로컬에서 이미지Cache보관 장소에서 찾는다. 없을경우 도커 허브에서 가져온다.
 
하이퍼 바이저란?
- 호스트 시스템에서 다수의 게스트OS를 구동할수 있게 해주는 소프트웨어. 하드웨어와 각각의 VM을 모니터링 하는 중간관리자.
  VM마다 독립적으로 자원 할당. 논리적으로 분리되어 있어, 한쪽VM의 오류가 다른쪽으로 퍼지진 않음.
  
도커와 기존VM의 차이점
- 도커 컨테이너는 하이퍼 바이저와 게스트OS가 필요하지 않으므로 오버헤드가 적어 더 가볍다.
  도커는 호스트OS위에 어플리케이션의 실행 피키지인 이미지를 배포. -> 같은 호소트, 다른 컨테이너와 동일한 커널을 공유. (도커엔진과 하이퍼바이저가 유사)
  
리눅스에서 사용되는 Cgroup 과 nameSpace
- 컨테이너와 호스트에서 실행되는 다른 프로세스 사이 벽을 만드는 리눅스 커널 기능들.

Cgroup
- cpu,메모리, network, HD i/o등 프로세스 그룹의 시스템 리소스 사용량을 관리
  어떤 어플리케이션이 사용량이 많으면 그 어플을 Cgroup에 넣어 cpu와 메모리 사용 제한 가능.
  
nameSpace
- 하나의 시스템에서 프로세스를 격리시킬 수 있는 가상화 기술.
  별개의 독립된 공간을 사용하는 것처럼 격리된 환경 제공.
  
위의 둘은 리눅스에서 사용된다고 했는데 난 윈도우 인데 어떻게 도커에서 사용되나?
- docker Clinet 에서 docker version입력. 도커 서버의OS가 리눅스 인것을 볼수 있다. 그렇기에 리눅스 커널을 사용하여 Cgroup및 nameSpace사용!
  
어떻게 도커 이미지가 컨테이너로 만들어 질까?
- 이미지는 응용 프로그램을 실행하는데 필요한 모든것을 포함하고 있다.
  필요한 모든것은 시작시 실행될 명령어(run appName), 파일 스냅샷(디렉토리나 파일을 카피 한것)
  
이미지로 컨테이너를 만드는 순서
- 1. Docker 클라이언트에 docker tun Image 입력시
  2. 도커 이미지에 있는 파일 스냅샷을 컨테이너 하드 디스크에 옮겨 준다.
  3. 이미지에서 가지고 있는 명령어(컨테이너가 실행될때 사용될 명령어)를 이용해 해당app을 실행시킨다.
 
  
  
  